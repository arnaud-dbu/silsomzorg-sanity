---
import { urlFor } from "../utils/image";
import { Image } from "astro:assets";
import Links from "../components/Links.astro";
import { PortableText } from "astro-portabletext";
import { srcSet } from "../utils/image";
import { halfWidthSizes } from "../utils/image";

const { block } = Astro.props;

let imageUrl = "";
try {
  imageUrl = block.image && urlFor(block.image).url();
} catch (error) {
  console.error("Error resolving image URL:", error);
}

const alignImage =
  block.image.imagePosition == "left" ? "lg:flex-row" : "lg:flex-row-reverse";
---

<div
  class=`${block.image ? "flex flex-col md:flex-row md:items-center gap-8 md:gap-10 lg:gap-12 xl:gap-16" : ""}  ${alignImage } `
>
  {
    block.image && imageUrl && (
      <div class="w-full lg:w-1/2 xl:w-2/5">
        <div
          class={`${block.fullWidth ? "js-pull-out" : ""}`}
          data-direction={`${block.image.imagePosition ?? ""}`}
        >
          <Image
            sizes={halfWidthSizes()}
            srcset={srcSet(imageUrl)}
            width={1000}
            height={1000}
            src={imageUrl}
            alt={block.image.alt ?? ""}
            class={`${block.fullWidth ? "" : "img-rounded aspect-[7/6]"}  object-cover`}
          />
        </div>
      </div>
    )
  }
  <div
    class=`flex flex-col gap-4 px-4   ${block.image ? "w-full lg:w-1/2 xl:w-3/5" : "lg:flex-row lg:gap-16 xl:gap-24" }`
  >
    <div class=`w-full ${block.image ? "" : "lg:w-1/2"} spacing-y `>
      <div class=`block-heading w-full`>
        <span>{block.tagline}</span>
        <h2>{block.title}</h2>
      </div>
      <div class="rich-text">
        <PortableText value={block.richText} />
      </div>
      {block.links && <Links data={block.links} />}
    </div>
  </div>
</div>
