const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/index.DCavTmKo.js","_astro/studio-component.BiR-rhKi.js","_astro/client.Cgjzrf3n.js","_astro/index2.D2ioLyxt.js"])))=>i.map(i=>d[i]);
import{o as fe,c as ye,u as J,a as Y,i as q,b as N,e as xe,f as se,_ as D,j as o,L as F,g as K,h as ge,k as Pe,l as ie,m as Ie,n as we,P as ve,p as C,q as be,s as W,E as je,S as Se,r as ke,t as _e,v as Ee,w as Te,B as Re,R as Ce,x as De,y as oe,z as $e,A as T,D as O,F as A,G,H as M,I as le,J as Le,K as U,T as _,M as X,N as z,O as de,Q as Me,U as ze,V as Ne,W as Oe,X as Ae,Y as Z,Z as ee,$ as Ve,a0 as Be,a1 as te,a2 as Q,a3 as We,a4 as Ge,a5 as He,a6 as Fe,a7 as ue,a8 as Ke,a9 as Ue,aa as Je,ab as Ye,ac as qe,ad as $,ae as Qe,af as Xe,ag as Ze,ah as et}from"./studio-component.BiR-rhKi.js";import{r as p}from"./client.Cgjzrf3n.js";function tt(){return fe(function(e,a){var t,l=!1;e.subscribe(ye(a,function(r){var i=t;t=r,l&&a.next([i,r]),l=!0}))})}const nt=[];function at(e){const{children:a,flatIndex:t,index:l,params:r,payload:i,siblingIndex:n}=e,{navigate:s,navigateIntent:d,resolvePathFromState:y}=J(),c=Y(),{panes:f,expand:h}=_e(),u=p.useMemo(()=>c?.panes||nt,[c?.panes]),m=p.useMemo(()=>f?.[f.length-2],[f]),g=l-1,v=p.useCallback(x=>{const I=u[g]||[],S=I[n],E=x(I,S),me=[...u.slice(0,g),E,...u.slice(g+1)];return{...c||{},panes:me}},[g,u,c,n]),w=p.useCallback(x=>{const I=v(x);return setTimeout(()=>s(I),0),I},[v,s]),b=p.useCallback(x=>{const I=v((S,E)=>[...S.slice(0,n),{...E,params:x},...S.slice(n+1)]);return y(I)},[v,y,n]),P=p.useCallback(x=>{w((I,S)=>[...I.slice(0,n),{...S,payload:x},...I.slice(n+1)])},[w,n]),j=p.useCallback(x=>{w((I,S)=>[...I.slice(0,n),{...S,params:x},...I.slice(n+1)])},[w,n]),k=p.useCallback(({id:x,parentRefPath:I,type:S,template:E})=>{s({panes:[...u.slice(0,g+1),[{id:x,params:{template:E.id,parentRefPath:Ee(I),type:S},payload:E.params}]]})},[g,s,u]),B=p.useMemo(()=>({index:t,groupIndex:g,siblingIndex:n,payload:i,params:r,hasGroupSiblings:u[g]?u[g].length>1:!1,groupLength:u[g]?u[g].length:0,routerPanesState:u,ChildLink:Te,BackLink:t?Re:void 0,ReferenceChildLink:Ce,handleEditReference:k,ParameterizedLink:De,replaceCurrent:(x={})=>{w(()=>[{id:x.id||"",payload:x.payload,params:x.params||{}}])},closeCurrent:()=>{w((x,I)=>x.length>1?x.filter(S=>S!==I):x)},closeCurrentAndAfter:(x=!0)=>{x&&m&&h(m.element),s({panes:[...u.slice(0,g)]})},duplicateCurrent:x=>{w((I,S)=>{const E={...S,payload:x?.payload||S.payload,params:x?.params||S.params};return[...I.slice(0,n),E,...I.slice(n)]})},setView:x=>{const I=oe(r,"view");return j(x?{...I,view:x}:I)},setParams:j,setPayload:P,createPathWithParams:b,navigateIntent:d}),[t,g,n,i,r,u,k,j,P,b,d,w,m,s,h]);return o.jsx($e.Provider,{value:B,children:a})}class R extends Error{cause;context;helpId;constructor({message:a,context:t,helpId:l,cause:r}){super(a),this.name="PaneResolutionError",this.context=t,this.helpId=l,this.cause=r}}const ne=new WeakMap;function V(e){const a=ne.get(e);if(a)return a;const t=Xe();return ne.set(e,t),t}const rt=e=>!!e&&typeof e?.then=="function",st=e=>q(e)?typeof e.serialize=="function":!1,it=e=>(a,t,l)=>{try{return e(a,t,l)}catch(r){throw r instanceof R?r:new R({message:typeof r?.message=="string"?r.message:"",context:t,cause:r})}},ot=e=>(...a)=>e(...a).pipe(Ze(1),et());function ce(e){const a=it(ot(e((t,l,r)=>{if(!t)throw new R({message:"Pane returned no child",context:l,helpId:"structure-item-returned-no-child"});return rt(t)||Ye(t)?qe(t).pipe(Q(i=>a(i,l,r))):st(t)?a(t.serialize(l),l,r):typeof t=="function"?a(t(l.id,l),l,r):$(t)})));return a}const ae=new WeakMap;function pe(e,a){const t=ae.get(e)||new Map;if(t){const i=t.get(a);if(i)return i}const l=e[a];if(typeof l!="function")throw new Error(`Expected property \`${a}\` to be a function but got ${typeof l} instead.`);const r=l.bind(e);return t.set(a,r),ae.set(e,t),r}async function lt(e){const a=new Map,t=ce(n=>(s,d,y)=>{const c=s&&`${V(s)}-${d.path.join("__")}`,f=c&&a.get(c);if(f)return f;const h=n(s,d,y);return c&&a.set(c,h),h}),l=[[{id:`__edit__${e.params.id}`,params:{...oe(e.params,["id"]),type:e.params.type},payload:e.payload}]];async function r({currentId:n,flatIndex:s,intent:d,params:y,parent:c,path:f,payload:h,unresolvedPane:u,levelIndex:m,structureContext:g}){if(!u)return[];const{id:v,type:w,...b}=y,P=await ue(t(u,{id:n,splitIndex:0,parent:c,path:f,index:s,params:{},payload:void 0,structureContext:g},s));return P.type==="document"&&P.id===v?[{panes:[...f.slice(0,f.length-1).map(j=>[{id:j}]),[{id:v,params:b,payload:h}]],depthIndex:f.length,levelIndex:m}]:P.canHandleIntent?.(d,y,{pane:P,index:s})||P.type==="documentList"&&P.schemaTypeName===w&&P.options.filter==="_type == $type"?[{panes:[...f.map(j=>[{id:j}]),[{id:y.id,params:b,payload:h}]],depthIndex:f.length,levelIndex:m}]:P.type==="list"&&P.child&&P.items?(await Promise.all(P.items.map((j,k)=>j.type==="divider"?Promise.resolve([]):r({currentId:j._id||j.id,flatIndex:s+1,intent:d,params:y,parent:P,path:[...f,j.id],payload:h,unresolvedPane:typeof P.child=="function"?pe(P,"child"):P.child,levelIndex:k,structureContext:g})))).flat():[]}const i=(await r({currentId:"root",flatIndex:0,levelIndex:0,intent:e.intent,params:e.params,parent:null,path:[],payload:e.payload,unresolvedPane:e.rootPaneNode,structureContext:e.structureContext})).sort((n,s)=>n.depthIndex===s.depthIndex?n.levelIndex-s.levelIndex:n.depthIndex-s.depthIndex)[0];return i?i.panes:l}const dt=(e,a)=>{const t=e.replace(/^__edit__/,""),{params:l,payload:r,structureContext:{resolveDocumentNode:i}}=a,{type:n,template:s}=l;if(!n)throw new Error(`Document type for document with ID ${t} was not provided in the router params.`);let d=i({schemaType:n,documentId:t}).id("editor");return s&&(d=d.initialValueTemplate(s,r)),d.serialize()};function ut(e){return`contextHash(${JSON.stringify({id:e.id,parentId:parent&&V(parent),path:e.path,index:e.index,splitIndex:e.splitIndex,serializeOptionsIndex:e.serializeOptions?.index,serializeOptionsPath:e.serializeOptions?.path})})`}const re=e=>{const a={type:e.type,id:e.routerPaneSibling.id,params:e.routerPaneSibling.params||{},payload:e.routerPaneSibling.payload||null,flatIndex:e.flatIndex,groupIndex:e.groupIndex,siblingIndex:e.siblingIndex,path:e.path,paneNode:e.type==="resolvedMeta"?V(e.paneNode):null};return`metaHash(${JSON.stringify(a)})`};function L({unresolvedPane:e,flattenedRouterPanes:a,parent:t,path:l,resolvePane:r,structureContext:i}){const[n,...s]=a,d=s[0],y={id:n.routerPaneSibling.id,splitIndex:n.siblingIndex,parent:t,path:[...l,n.routerPaneSibling.id],index:n.flatIndex,params:n.routerPaneSibling.params||{},payload:n.routerPaneSibling.payload,structureContext:i};try{return r(e,y,n.flatIndex).pipe(Q(c=>{const f={type:"resolvedMeta",...n,paneNode:c,path:y.path},h=s.map((m,g)=>({type:"loading",path:[...y.path,...s.slice(g).map((v,w)=>`[${m.flatIndex+w}]`)],paneNode:null,...m}));if(!s.length)return $([f]);let u;return d?.routerPaneSibling.id.startsWith("__edit__")?u=L({unresolvedPane:dt,flattenedRouterPanes:s,parent:t,path:y.path,resolvePane:r,structureContext:i}):n.groupIndex===d?.groupIndex?u=L({unresolvedPane:e,flattenedRouterPanes:s,parent:t,path:l,resolvePane:r,structureContext:i}):u=L({unresolvedPane:typeof c.child=="function"?pe(c,"child"):c.child,flattenedRouterPanes:s,parent:c,path:y.path,resolvePane:r,structureContext:i}),Qe($([f,...h]),u.pipe(T(m=>[f,...m])))}))}catch(c){if(c instanceof R&&(c.context&&console.warn(`Pane resolution error at index ${c.context.index}${c.context.splitIndex>0?` for split pane index ${c.context.splitIndex}`:""}: ${c.message}${c.helpId?` - see ${de(c.helpId)}`:""}`,c),c.helpId==="structure-item-returned-no-child"))return $([]);throw c}}function ct({routerPanesStream:e,rootPaneNode:a,initialCacheState:t={cacheKeysByFlatIndex:[],flattenedRouterPanes:[],resolvedPaneCache:new Map,resolvePane:()=>Ge},structureContext:l}){return e.pipe(T(r=>[[{id:"root"}],...r]),T(r=>r.flatMap((i,n)=>i.map((s,d)=>({routerPaneSibling:s,groupIndex:n,siblingIndex:d}))).map((i,n)=>({...i,flatIndex:n}))),Be([]),tt(),T(([r,i])=>{for(let n=0;n<i.length;n++){const s=r[n],d=i[n];if(!K(s,d))return{flattenedRouterPanes:i,diffIndex:n}}return{flattenedRouterPanes:i,diffIndex:i.length}}),te((r,i)=>{const{cacheKeysByFlatIndex:n,resolvedPaneCache:s}=r,{flattenedRouterPanes:d,diffIndex:y}=i,c=n.slice(0,y+1),f=n.slice(y+1),h=new Set(c.flatMap(m=>Array.from(m))),u=f.flatMap(m=>Array.from(m)).filter(m=>!h.has(m));for(const m of u)s.delete(m);return{flattenedRouterPanes:d,cacheKeysByFlatIndex:n,resolvedPaneCache:s,resolvePane:ce(m=>(g,v,w)=>{const b=g&&`${V(g)}-${ut(v)}`,P=b&&s.get(b);if(P)return P;const j=m(g,v,w);if(!b)return j;const k=n[w]||new Set;return k.add(b),n[w]=k,s.set(b,j),j})}},t),Q(({flattenedRouterPanes:r,resolvePane:i})=>L({unresolvedPane:a,flattenedRouterPanes:r,parent:null,path:[],resolvePane:i,structureContext:l}))).pipe(te((r,i)=>i.map((n,s)=>{const d=r[s];return!d||n.type!=="loading"?n:d.routerPaneSibling.id===n.routerPaneSibling.id?d:n}),[]),We((r,i)=>{if(r.length!==i.length)return!1;for(let n=0;n<i.length;n++){const s=r[n],d=i[n];if(re(s)!==re(d))return!1}return!0}))}function pt(){const e=p.useMemo(()=>new He(1),[]),a=p.useMemo(()=>e.asObservable().pipe(T(l=>l?.panes||[])),[e]),{state:t}=J();return p.useEffect(()=>{e.next(t)},[t,e]),a}function ht(){const[e,a]=p.useState();if(e)throw e;const{structureContext:t,rootPaneNode:l}=N(),[r,i]=p.useState({paneDataItems:[],resolvedPanes:[],routerPanes:[]}),n=pt();return p.useEffect(()=>{const s=ct({rootPaneNode:l,routerPanesStream:n,structureContext:t}).pipe(T(d=>{const y=d.reduce((h,u)=>{const m=h[u.groupIndex]||[];return m[u.siblingIndex]=u.routerPaneSibling,h[u.groupIndex]=m,h},[]),c=y.length,f=d.map(h=>{const{groupIndex:u,flatIndex:m,siblingIndex:g,routerPaneSibling:v,path:w}=h,b=v.id,P=y[u+1];return{active:u===c-2,childItemId:P?.[0].id??null,index:m,itemId:v.id,groupIndex:u,key:`${h.type==="loading"?"unknown":h.paneNode.id}-${b}-${g}`,pane:h.type==="loading"?C:h.paneNode,params:v.params||{},path:w.join(";"),payload:v.payload,selected:m===d.length-1,siblingIndex:g}});return{paneDataItems:f,routerPanes:y,resolvedPanes:f.map(h=>h.pane)}})).subscribe({next:d=>i(d),error:d=>a(d)});return()=>s.unsubscribe()},[l,n,t]),r}async function mt(e,a,t){if(a&&t)return{id:a,type:t};if(!a&&t)return{id:Fe(),type:t};if(a&&!t){const l=await ue(e.resolveTypeForDocument(a));return{id:a,type:l}}throw new R({message:"Neither document `id` or `type` was provided when trying to resolve intent."})}const ft={},yt=p.memo(function(){const{navigate:e}=J(),a=Y(p.useCallback(s=>{const d=typeof s.intent=="string"?s.intent:void 0;return d?{intent:d,params:q(s.params)?s.params:ft,payload:s.payload}:void 0},[])),{rootPaneNode:t,structureContext:l}=N(),r=xe(),[i,n]=p.useState(null);if(i)throw i;return p.useEffect(()=>{if(a){const{intent:s,params:d,payload:y}=a;let c=!1;async function f(){const{id:h,type:u}=await mt(r,typeof d.id=="string"?d.id:void 0,typeof d.type=="string"?d.type:void 0);if(c)return;const m=await lt({intent:s,params:{...d,id:h,type:u},payload:y,rootPaneNode:t,structureContext:l});c||e({panes:m},{replace:!0})}return f().catch(n),()=>{c=!0}}},[r,a,e,t,l]),null}),xt=se.span`
  &:not(:last-child)::after {
    content: ' ➝ ';
    opacity: 0.5;
  }
`;function gt(e){return e.replace(/\(\.\.\.\)\./g,`(...)
  .`).replace(/__WEBPACK_IMPORTED_MODULE_\d+_+/g,"").replace(/___default\./g,".").replace(new RegExp(` \\(https?:\\/\\/${window.location.host}`,"g")," (")}function Pt({error:e}){if(!(e instanceof R))throw e;const{cause:a}=e,{t}=O(A),l=a?.stack||e.stack,r=l&&!(a instanceof G)&&!e.message.includes("Module build failed:"),i=a instanceof G?a.path:[],n=a instanceof G&&a.helpId||e.helpId,s=p.useCallback(()=>{window.location.reload()},[]);return o.jsx(M,{height:"fill",overflow:"auto",padding:4,sizing:"border",tone:"critical",children:o.jsxs(le,{children:[o.jsx(Le,{as:"h2",children:t("structure-error.header.text")}),o.jsxs(M,{marginTop:4,padding:4,radius:2,overflow:"auto",shadow:1,tone:"inherit",children:[i.length>0&&o.jsxs(U,{space:2,children:[o.jsx(_,{size:1,weight:"medium",children:t("structure-error.structure-path.label")}),o.jsx(X,{children:i.slice(1).map((d,y)=>o.jsx(xt,{children:d},`${d}-${y}`))})]}),o.jsxs(U,{marginTop:4,space:2,children:[o.jsx(_,{size:1,weight:"medium",children:t("structure-error.error.label")}),o.jsx(X,{children:r?gt(l):e.message})]}),n&&o.jsx(z,{marginTop:4,children:o.jsx(_,{children:o.jsx("a",{href:de(n),rel:"noopener noreferrer",target:"_blank",children:t("structure-error.docs-link.text")})})}),o.jsx(z,{marginTop:4,children:o.jsx(Me,{text:t("structure-error.reload-button.text"),icon:ze,tone:"primary",onClick:s})})]})]})})}function It(e){const{isSelected:a,pane:t,paneKey:l}=e,r=q(t)&&t.type||null,{t:i}=O(A);return o.jsxs(Ne,{id:l,selected:a,children:[o.jsx(Oe,{title:i("panes.unknown-pane-type.title")}),o.jsx(Ae,{children:o.jsx(z,{padding:4,children:typeof r=="string"?o.jsx(_,{as:"p",muted:!0,children:o.jsx(Z,{t:i,i18nKey:"panes.unknown-pane-type.unknown-type.text",values:{type:r}})}):o.jsx(_,{as:"p",muted:!0,children:o.jsx(Z,{t:i,i18nKey:"panes.unknown-pane-type.missing-type.text"})})})})]})}const wt={component:p.lazy(()=>D(()=>import("./index.DCavTmKo.js"),__vite__mapDeps([0,1,2]))),document:p.lazy(()=>D(()=>import("./studio-component.BiR-rhKi.js").then(e=>e.b1),__vite__mapDeps([1,2])).then(function(e){return e.pane})),documentList:p.lazy(()=>D(()=>import("./studio-component.BiR-rhKi.js").then(e=>e.b1),__vite__mapDeps([1,2])).then(function(e){return e.pane$1})),list:p.lazy(()=>D(()=>import("./index2.D2ioLyxt.js"),__vite__mapDeps([3,1,2])))},vt=p.memo(function(e){const{active:a,childItemId:t,groupIndex:l,index:r,itemId:i,pane:n,paneKey:s,params:d,payload:y,path:c,selected:f,siblingIndex:h}=e,u=wt[n.type]||It;return o.jsx(at,{flatIndex:r,index:l,params:d,payload:y,siblingIndex:h,children:o.jsx(p.Suspense,{fallback:o.jsx(F,{paneKey:s,path:c,selected:f}),children:o.jsx(u,{childItemId:t||"",index:r,itemId:i,isActive:a,isSelected:f,paneKey:s,pane:n})})})},({params:e={},payload:a=null,...t},{params:l={},payload:r=null,...i})=>{if(!K(e,l)||!K(a,r))return!1;const n=new Set([...Object.keys(t),...Object.keys(i)]);for(const s of n)if(t[s]!==i[s])return!1;return!0});function bt(){const{t:e}=O(A);return o.jsx(M,{height:"fill",children:o.jsx(ee,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:o.jsx(le,{width:0,children:o.jsx(M,{padding:4,radius:2,shadow:1,tone:"caution",children:o.jsxs(ee,{children:[o.jsx(z,{children:o.jsx(_,{size:1,children:o.jsx(Ve,{})})}),o.jsxs(U,{flex:1,marginLeft:3,space:3,children:[o.jsx(_,{as:"h1",size:1,weight:"medium",children:e("no-document-types-screen.title")}),o.jsx(_,{as:"p",muted:!0,size:1,children:e("no-document-types-screen.subtitle")}),o.jsx(_,{as:"p",muted:!0,size:1,children:o.jsx("a",{href:"https://www.sanity.io/docs/create-a-schema-and-configure-sanity-studio",target:"_blank",rel:"noreferrer",children:e("no-document-types-screen.link-text")})})]})]})})})})})}const jt=e=>{const{documentId:a,documentType:t}=e,l=Ke(a,t),r=ie(),{t:i}=O(A),n=!l?.published&&!l?.draft,s=l?.draft||l?.published,d=r.get(t),{value:y,isLoading:c}=Ue({enabled:!0,schemaType:d,value:s}),f=n?i("browser-document-title.new-document",{schemaType:d?.title||d?.name}):y?.title||i("browser-document-title.untitled-document"),h=l.ready&&!c,u=he(f);return p.useEffect(()=>{h&&(document.title=u)},[f,h,u]),null},H=e=>{const{title:a}=e,t=he(a);return p.useEffect(()=>{document.title=t},[t,a]),null},St=e=>{const{resolvedPanes:a}=e;if(!a?.length)return null;const t=a[a.length-1];return _t(t)?o.jsx(H,{}):kt(t)?t?.title?o.jsx(H,{title:t.title}):o.jsx(jt,{documentId:t.options.id,documentType:t.options.type}):o.jsx(H,{title:t?.title})};function he(e){const a=N().structureContext.title;return[e,a].filter(t=>t).join(" | ")}function kt(e){return e!==C&&e.type==="document"}function _t(e){return e===C}const Et=se(Je)`
  min-height: 100%;
  min-width: 320px;
`,Tt=ge("mod+s"),Rt=p.memo(function({onPaneChange:e}){const{push:a}=Pe(),t=ie(),{layoutCollapsed:l,setLayoutCollapsed:r}=N(),{paneDataItems:i,resolvedPanes:n}=ht(),s=Y(p.useCallback(u=>typeof u.intent=="string",[])),{sanity:{media:d}}=Ie(),[y,c]=p.useState(null),f=p.useCallback(()=>r(!0),[r]),h=p.useCallback(()=>r(!1),[r]);return p.useEffect(()=>{n.length&&e(n)},[e,n]),p.useEffect(()=>{const u=m=>{Tt(m)&&(m.preventDefault(),a({closable:!0,id:"auto-save-message",status:"info",title:"Your work is automatically saved!",duration:4e3}))};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[a]),t._original?.types.some(we)?o.jsxs(ve,{element:y||null,children:[o.jsxs(Et,{flex:1,height:l?void 0:"fill",minWidth:d[1],onCollapse:f,onExpand:h,children:[i.map(({active:u,childItemId:m,groupIndex:g,itemId:v,key:w,pane:b,index:P,params:j,path:k,payload:B,siblingIndex:x,selected:I})=>o.jsx(p.Fragment,{children:b===C?o.jsx(F,{paneKey:w,path:k,selected:I}):o.jsx(vt,{active:u,groupIndex:g,index:P,pane:b,childItemId:m,itemId:v,paneKey:w,params:j,payload:B,path:k,selected:I,siblingIndex:x})},`${b===C?"loading":b.type}-${P}`)),i.length<=1&&s&&o.jsx(F,{paneKey:"intent-resolver"})]}),o.jsx(St,{resolvedPanes:n}),o.jsx("div",{"data-portal":"",ref:c})]}):o.jsx(bt,{})});function $t({tool:{options:e}}){const{unstable_sources:a}=be(),[t]=a,{source:l,defaultDocumentNode:r,structure:i}=e||{};p.useEffect(()=>(W([]),()=>W([])),[]);const[{error:n},s]=p.useState({error:null});return n?o.jsx(Pt,{error:n}):o.jsx(je,{onCatch:s,children:o.jsx(Se,{name:l||t.name,children:o.jsxs(ke,{defaultDocumentNode:r,structure:i,children:[o.jsx(Rt,{onPaneChange:W}),o.jsx(yt,{})]})})})}export{$t as default};
